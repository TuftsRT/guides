
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Extracting Ancient Placenames using Named Entity Recognition and spaCy &#8212; TTS Research Technology Guides</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/style/bugfix.css?v=736ec69d" />
    <link rel="stylesheet" type="text/css" href="../../_static/style/footer.css?v=5f497d55" />
    <link rel="stylesheet" type="text/css" href="../../_static/style/gallery.css?v=c2bd73dd" />
    <link rel="stylesheet" type="text/css" href="../../_static/style/navbar.css?v=147f7454" />
    <link rel="stylesheet" type="text/css" href="../../_static/style/sidebar.css?v=ff9f960e" />
    <link rel="stylesheet" type="text/css" href="../../_static/style/switcher.css?v=3e40d84b" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-ZJ5LXFRJ2G"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-ZJ5LXFRJ2G');
            </script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'nlp/deep-learning/ner-spacy';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.0';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/TuftsRT/guides/refs/heads/switcher/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.0.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <script src="../../_static/script/dynamic-nav-dropdown.js?v=5e71fbcf"></script>
    <link rel="canonical" href="https://rtguides.it.tufts.edu/nlp/deep-learning/ner-spacy.html" />
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Machine Translation (mostly) from Scratch using PyTorch" href="rnn-pytorch.html" />
    <link rel="prev" title="Encoder-only Transformers: Bidirectional Encoder Representations from Transformers (BERT)" href="encoder-pytorch.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="20251205" />
    <meta name="docbuild:last-update" content="Dec 05, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder=""
         aria-label=""
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
  <aside class="bd-header-announcement d-print-none d-none" aria-label="Announcement" data-pst-announcement-url="https://raw.githubusercontent.com/TuftsRT/guides/refs/heads/announcement/announcement.html"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">     
<a class="navbar-brand logo" href="../../index.html">
           
  <img
    src="../../_static/jumbo.png"
    class="logo__image only-light"
    alt=""
  />
  <img
    src="../../_static/jumbo.png"
    class="logo__image only-dark pst-js-only"
    alt=""
  />
   
  <p class="title logo__title" id="long_title">
    TTS Research Technology Guides
  </p>
  
  <p class="title logo__title" id="short_title">TTS RT Guides</p>
   
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../hpc/index.html">
    High-Performance Computing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../bio/index.html">
    Bioinformatics
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Natural Language Processing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://go.tufts.edu/geospatial">
    Geospatial
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../viz/index.html">
    Data Visualization
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://rtguides.it.tufts.edu/tags/index.html" title="Tags" class="nav-link pst-navbar-icon" rel="noopener" target="_self" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-tags fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Tags</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/TuftsRT/guides" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="mailto:tts-research@tufts.edu" title="Email" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Email</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../hpc/index.html">
    High-Performance Computing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../bio/index.html">
    Bioinformatics
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Natural Language Processing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://go.tufts.edu/geospatial">
    Geospatial
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../viz/index.html">
    Data Visualization
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://rtguides.it.tufts.edu/tags/index.html" title="Tags" class="nav-link pst-navbar-icon" rel="noopener" target="_self" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-tags fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Tags</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/TuftsRT/guides" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="mailto:tts-research@tufts.edu" title="Email" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Email</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links" aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
     Natural Language Processing 
  </p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../text-proc/index.html">Text Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webscraping/index.html">Webscraping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pretrained-models/index.html">Using Pretrained Models</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Deep Learning</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="decoder-pytorch.html">Decoder-only Transformers: Generative Pre-trained Transformers (GPTs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="encoder-pytorch.html">Encoder-only Transformers: Bidirectional Encoder Representations from Transformers (BERT)</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Extracting Ancient Placenames using Named Entity Recognition and <code class="docutils literal notranslate"><span class="pre">spaCy</span></code></a></li>



<li class="toctree-l2"><a class="reference internal" href="rnn-pytorch.html">Machine Translation (mostly) from Scratch using <code class="docutils literal notranslate"><span class="pre">PyTorch</span></code></a></li>

<li class="toctree-l2"><a class="reference internal" href="tokenizers.html">Byte-Pair Encoding Tokenization</a></li>
<li class="toctree-l2"><a class="reference internal" href="w2v-from-scratch.html">word2vec using <code class="docutils literal notranslate"><span class="pre">numpy</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="w2v-gensim.html">Natural Language Processing: Using Word Vectors for Textual Analysis</a></li>

</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../llms/index.html">Large Language Models</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"> 

<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a
        href="../../index.html"
        class="nav-link"
        aria-label="Home"
      >
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
     
    <li class="breadcrumb-item">
      <a href="../index.html" class="nav-link"
        >Natural Language Processing</a
      >
    </li>
     
    <li class="breadcrumb-item">
      <a href="index.html" class="nav-link"
        >Deep Learning</a
      >
    </li>
     
    <li class="breadcrumb-item active" aria-current="page">
      Extracting Ancient...
    </li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="extracting-ancient-placenames-using-named-entity-recognition-and-spacy">
<h1>Extracting Ancient Placenames using Named Entity Recognition and <code class="docutils literal notranslate"><span class="pre">spaCy</span></code><a class="headerlink" href="#extracting-ancient-placenames-using-named-entity-recognition-and-spacy" title="Link to this heading">#</a></h1>
<p>In this notebook, we are going to explore an important subfield of natural language processing, named entity recognition or NER. This notebook was inspired by William Mattingly’s textbook on the subject, which you can find here: <a class="reference external" href="https://ner.pythonhumanities.com/intro.html">https://ner.pythonhumanities.com/intro.html</a>. I encourage you to browse this book and play around with the code that he provides.</p>
<p>Objectives:</p>
<ul class="simple">
<li><p>Understand what NER is and why it matters</p></li>
<li><p>Collect a training data for a machine learning NER approach</p></li>
<li><p>Train a NER model using <code class="docutils literal notranslate"><span class="pre">spaCy</span></code>’s utilities</p></li>
<li><p>Do some basic inference to see where our model succeeds and where it fails</p></li>
</ul>
<p>What is NER and why does it matter?</p>
<p>Named entity recognition describes any method which uses computational methods to extract from unstructured text names of people, places or things. It is a hard classification task, meaning that every word in a document is either a type of named entity or it is not. For example in the following sentences:</p>
<blockquote>
<div><p>My name is Peter Nadel. I work at Tufts University.</p>
</div></blockquote>
<p>the token ‘Peter Nadel’ could be tagged as a PERSON tag, where as Tufts Univerisity could be tagged with a PLACE tag. Importantly, in NER, no token can receive more than one tag.</p>
<p>As a result, NER can be using in a wide variety of fields and applications.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The example we&#39;ll be looking at today comes from these maps that I made</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">IFrame</span>

<span class="n">IFrame</span><span class="p">(</span>
    <span class="s2">&quot;https://tuftsgis.maps.arcgis.com/apps/webappviewer/index.html?id=576ff8f0e3954ad781916e94dfb34f7e&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">1400</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To make a map like the one we see above, I needed to extract place names from an ancient text. Thankfully, ToposText (<a class="reference external" href="https://topostext.org/">https://topostext.org/</a>) has marked all of the place names already. So why do we need NER?</p>
<p>ToposText has a lot of texts, but it doesn’t have every ancient text. I work quite frequently with faculty members from Classic Studies, examining texts much more obscure than those in ToposText, which may not be digitized at all, let alone have place names marked. So, what we need is an ancient place name NER model, which we can pass any amount of texts and get back all of the places in that text.</p>
<p><em>A quick note on <code class="docutils literal notranslate"><span class="pre">spaCy</span></code>’s native English NER</em>: <code class="docutils literal notranslate"><span class="pre">spaCy</span></code> has NER built into their English and other models. This NER is of good quality for modern texts, but is quite poor when applied to texts that aren’t that similar to the training data (in the English model’s case: modern news articles scraped from the web). For specialty tasks like the one we will do today, training your own model will always return better results.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="scraping">
<h1>Scraping<a class="headerlink" href="#scraping" title="Link to this heading">#</a></h1>
<p>Here, I will show how we got our training data and what form it has to be in for training NER models with <code class="docutils literal notranslate"><span class="pre">spaCy</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">bs4</span><span class="w"> </span><span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">res_html</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s2">&quot;https://topostext.org/work/148&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">text</span>  <span class="c1"># The Natural Histories, Plinius Senior</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">topos_test</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">res_html</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s2">&quot;html&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p_tags</span> <span class="o">=</span> <span class="n">topos_test</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
<span class="n">p_tags</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">a</span>  <span class="c1"># first a tag in the third p tag</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">spaCy</span></code> expects the training data to be in <code class="docutils literal notranslate"><span class="pre">jsonl</span></code> format, meaning that there must be a list where each element is a list that contains the text and a dictionary of the entities that are in the text, with their label (in this case, their HTML class).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">collections</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">string</span>

<span class="n">TRAIN_DATA</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p_tags</span><span class="p">):</span>
    <span class="n">document</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">p_text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;(§\s\d\.\d+)|(§\s\d+)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">document</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\xa0\xa0</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>

    <span class="n">ent_dict</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">):</span>
        <span class="n">span_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">istitle</span><span class="p">():</span>
            <span class="k">if</span> <span class="s2">&quot;href&quot;</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
                <span class="n">span_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">))</span>
                <span class="p">)</span>
                <span class="n">span_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">span_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">))</span>
                <span class="p">)</span>
                <span class="n">span_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">span_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ent_dict</span><span class="p">[</span><span class="s2">&quot;entities&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span_list</span><span class="p">)</span>
    <span class="n">document</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">ent_dict</span><span class="p">))</span>
    <span class="n">TRAIN_DATA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TRAIN_DATA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Importantly though, you can’t just use the text of the entities. It must be the indices of the names within the text. So we can do that below.</p>
<section id="task-1">
<h2>TASK 1<a class="headerlink" href="#task-1" title="Link to this heading">#</a></h2>
<p>We can’t feed our model the raw text of a name. Instead, we need to give it the indices of the name in the original text.</p>
<p>Let’s write some code to do that.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">TRAIN_DATA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">test</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">type</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;Muses&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">type</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">],</span> <span class="nb">type</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">type</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">type</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>My Solution</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;Muses&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<section id="answer">
<h3>Answer<a class="headerlink" href="#answer" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">TRAIN_DATA</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">List[String,</span> <span class="pre">Dict[List[String,</span> <span class="pre">String]]]</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;Muses&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># using find method</span>
<span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># add length of the original string</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">start</span><span class="p">,</span> <span class="n">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># check</span>
<span class="n">test</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">396</span><span class="p">:</span><span class="mi">401</span><span class="p">]</span>  <span class="c1"># looks good!</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># turn this into a function we can use for each string</span>
<span class="k">def</span><span class="w"> </span><span class="nf">names2indices</span><span class="p">(</span><span class="n">train_data_instance</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_data_instance</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">]):</span>
        <span class="c1"># get indices</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">train_data_instance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">pass</span>

        <span class="c1"># update dict</span>
        <span class="n">train_data_instance</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># remove string name</span>
        <span class="n">train_data_instance</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>  <span class="c1"># add end</span>
        <span class="n">train_data_instance</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">start</span><span class="p">)</span>  <span class="c1"># add start</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># do it to all of them in our training data</span>
<span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">TRAIN_DATA</span><span class="p">:</span>
    <span class="k">if</span> <span class="s2">&quot;entities&quot;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">names2indices</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TRAIN_DATA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="completing-our-training-data">
<h2>Completing our training data<a class="headerlink" href="#completing-our-training-data" title="Link to this heading">#</a></h2>
<p>Now that we can do this to one ToposText URL we can do it to all the others.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># can make this into a single function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_TRAIN_DATA</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes in a ToposText URL and creates spaCy training data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># scraping</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
        <span class="n">res_html</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">text</span>

        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">res_html</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s2">&quot;html&quot;</span><span class="p">)</span>
        <span class="n">TRAIN_DATA</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">p_tags</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p_tags</span><span class="p">):</span>
            <span class="n">document</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">p_text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;(§\s\d\.\d+)|(§\s\d+)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">document</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\xa0\xa0</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>

            <span class="n">ent_dict</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">):</span>
                <span class="n">span_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">istitle</span><span class="p">():</span>
                    <span class="k">if</span> <span class="s2">&quot;href&quot;</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
                        <span class="n">span_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                        <span class="n">span_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">span_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                            <span class="n">span_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="k">continue</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">span_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ent_dict</span><span class="p">[</span><span class="s2">&quot;entities&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span_list</span><span class="p">)</span>
            <span class="n">document</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">ent_dict</span><span class="p">))</span>
            <span class="n">TRAIN_DATA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>

        <span class="c1"># reformatting</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">TRAIN_DATA</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;entities&quot;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">names2indices</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">TRAIN_DATA</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">create_TRAIN_DATA</span><span class="p">(</span><span class="s2">&quot;https://topostext.org/work/148&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TRAIN_DATA</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Max of 901</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">901</span><span class="p">)):</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">create_TRAIN_DATA</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;https://topostext.org/work/</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">train</span><span class="p">:</span>
        <span class="n">TRAIN_DATA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">TRAIN_DATA</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TRAIN_DATA</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># pickling let&#39;s us save this work so we don&#39;t have to do it again</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;topostext_training_data.pkl&quot;</span>

<span class="c1"># pickle and save the data</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">TRAIN_DATA</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training data saved to </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="training">
<h1>Training<a class="headerlink" href="#training" title="Link to this heading">#</a></h1>
<p>Now that we have our data in the correct form, we can start training.</p>
<p>First, we have to convert the <code class="docutils literal notranslate"><span class="pre">TRAIN_DATA</span></code> object into a special <code class="docutils literal notranslate"><span class="pre">spaCy</span></code> type called a <code class="docutils literal notranslate"><span class="pre">DocBin</span></code> (code taken from Mattingly).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">tufts</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">static</span><span class="o">/</span><span class="mi">2</span><span class="n">p4ez2vas90v2zn8mf3lgdv6lltzl75d</span><span class="o">.</span><span class="n">pkl</span> <span class="o">-</span><span class="n">O</span> <span class="n">topostext_training_data</span><span class="o">.</span><span class="n">pkl</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/content/topostext_training_data.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">loaded_training_data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loaded training data length:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">loaded_training_data</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_training_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The above section in the original Greek.</p>
<p><img alt="Screenshot 2023-10-16 at 10.00.16 AM.png" src="data:image/png;base64,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UJj8JB7c8moFAwUDBQOFyRcaKBgoGCgYmMQYKEx+DAZ30aJFgf/AVVddFR588MExaHV8m3jooYfCnDlzxrcTY9z6I488Em6++eYxbrU0VzDQGQOTkskvXrw4XHHFFWHevHn29k8++WRYsGBBZ0yM4tNPfOIT4fWvf33461//GtZbb71w6KGH9q218847L+y5557hox/9aDj88MPDX/7ylxHX/bvf/S4ceOCB4T/+4z/CCSecYP3utdIvfelL9q533313r0VHJf///M//hB122CHccccdw6r/t7/9bbjuuuus7JVXXmmLdV4R+F977bXDXXfdlT+ye46J+v73vx922WWXAE1897vfrRb/2gKjkMji+8QTT4xCzc9U+eMf/zj827/9W7jwwgufSay5+vOf/xwuv/zysGTJEnvK/HBhqCZ7SRouBjigbLLBhz70oajJFldYYYWoCRX322+/+IUvfGHcXlPEG9/0pjfFM844I7761a+Okvj60pezzz47vuIVr4hiKvH++++P73nPe+I//uM/jqju0047LS6//PLxzDPPjFow4kc+8pH4mte8Joo59FTvwoULrS+nnnpqo3Ka8HHTTTeNyyyzDAfmxXXXXXfIf3/29re/Pf7pT39qVC+ZtMjHz33uc5Fy//qv/9q4XJpxww03jO9973stiX6+853vTB/bNX0+9thjh6R7wmc+85m43XbbRe3k4m233RbXWGONuOuuu/rjMfnl/TfYYANr65RTTjFcX3TRRX1t+9vf/naUgBBf9KIXxYcffri27muvvdZo9+Uvf7nR17e+9a24zjrr9ExntZWXxBYMhJa7SXLzla98xd5k9uzZcdttt42S4OIDDzwwbm931FFHxdtvvz1KKo6SAvvWj7333ju++93vruqTtBl32mmn6r7XC5jhP/zDP8R///d/r4pqBxSf9axnxW984xtVWtMLqabid77znabZLd+WW25pjL6uEIv2P//zP9c9apQmKTGuuuqqkQWlV/jDH/4Q77zzTisGg2Y8U9DuMX7yk59Mk4ZcaxcXv/rVr1bpxxxzTIS5jSX8/ve/N4GDNt/1rnfF5z//+XHnnXcelS4gdPzv//5vbd0///nP49VXXx0ff/zx+MUvftHG9Uc/+lFt3pI4Mgw0ZvLz710Yz7n8rkatPfrY4vjzK+bFex96vFH+kml4GPjBD35g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" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">mkdir</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">spacy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">spacy.tokens</span><span class="w"> </span><span class="kn">import</span> <span class="n">DocBin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>


<span class="k">def</span><span class="w"> </span><span class="nf">convert</span><span class="p">(</span><span class="n">lang</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">TRAIN_DATA</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
    <span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span>
    <span class="n">nlp</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="mi">2000000</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">DocBin</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">text</span><span class="p">,</span> <span class="n">annot</span> <span class="ow">in</span> <span class="n">TRAIN_DATA</span><span class="p">:</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">make_doc</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">ents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="s2">&quot;entities&quot;</span> <span class="ow">in</span> <span class="n">annot</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">annot</span><span class="p">[</span><span class="s2">&quot;entities&quot;</span><span class="p">]:</span>
                <span class="n">span</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">char_span</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">span</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Skipping entity [</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">] in the following text because the character span &#39;</span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; does not align with token boundaries:</span><span class="se">\n\n</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">ents</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="n">db</span><span class="o">.</span><span class="n">to_disk</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># two splits: first split (train and validation for testing our model after it trains)</span>
<span class="n">train_valid</span><span class="p">,</span> <span class="n">valid_post_training</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">loaded_training_data</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="n">train</span><span class="p">,</span> <span class="n">valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train_valid</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_post_training</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="n">convert</span><span class="p">(</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="s2">&quot;/content/data/train.spacy&quot;</span><span class="p">)</span>
<span class="n">convert</span><span class="p">(</span><span class="s2">&quot;en&quot;</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="s2">&quot;/content/data/valid.spacy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;/content/data&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="task-2">
<h2>TASK 2<a class="headerlink" href="#task-2" title="Link to this heading">#</a></h2>
<p>We still need one final piece before we can start training. This is the config file that will tell the training program how to initialize our set up. We can download a blank version here: <a class="reference external" href="https://spacy.io/usage/training">https://spacy.io/usage/training</a>.</p>
<p>Finally we just need to add the file locations of our training and validation data. In Colab, double-clicking on the base_config.cfg file will open up an editor on the side. In the train field, put <code class="docutils literal notranslate"><span class="pre">data/train.spacy</span></code> and in the dev field, put <code class="docutils literal notranslate"><span class="pre">data/valid.spacy</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spacy</span> <span class="n">init</span> <span class="n">fill</span><span class="o">-</span><span class="n">config</span> <span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">base_config</span><span class="o">.</span><span class="n">cfg</span> <span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># really useful feature in spacy</span>
<span class="err">!</span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spacy</span> <span class="n">debug</span> <span class="n">data</span> <span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spacy</span> <span class="n">train</span> <span class="n">config</span><span class="o">.</span><span class="n">cfg</span> <span class="o">--</span><span class="n">output</span> <span class="n">models</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># zip up model for easier download</span>
<span class="err">!</span><span class="nb">zip</span> <span class="o">-</span><span class="n">r</span> <span class="n">topostext_ner_model_full</span><span class="o">.</span><span class="n">zip</span> <span class="n">models</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">google.colab</span><span class="w"> </span><span class="kn">import</span> <span class="n">files</span>

<span class="n">files</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;topostext_ner_model_full.zip&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="inference">
<h1>Inference<a class="headerlink" href="#inference" title="Link to this heading">#</a></h1>
<p>Now that we have a model, we can see how well we did. For this inference step, I want to use example texts that I know were not in the training data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pnadelofficial</span><span class="o">/</span><span class="n">topos_text_NER</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">unzip</span> <span class="n">topos_text_NER</span><span class="o">/</span><span class="n">topostext_ner_model_full</span><span class="o">.</span><span class="n">zip</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inf_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">An upper vest, once Helen&#39;s rich attire,</span>
<span class="s2">From Argos by the fam&#39;d adultress brought,</span>
<span class="s2">With golden flow&#39;rs and winding foliage wrought,</span>
<span class="s2">Her mother Leda&#39;s present, when she came</span>
<span class="s2">To ruin Troy and set the world on flame;</span>
<span class="s2">The scepter Priam&#39;s eldest daughter bore,</span>
<span class="s2">Her orient necklace, and the crown she wore</span>
<span class="s2">Of double texture, glorious to behold,</span>
<span class="s2">One order set with gems, and one with gold.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Vergil Aenid 1.643</span>
<span class="c1"># perseus.tufts.edu/hopper/text?doc=Perseus%3Atext%3A1999.02.0052%3Abook%3D1%3Acard%3D643</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">spacy</span>

<span class="n">trained_nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;models/model-best&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">trained_nlp</span><span class="p">(</span><span class="n">inf_text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">people</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="s2">&quot;people&quot;</span><span class="p">:</span>
        <span class="n">people</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">people</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">!</span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spacy</span> <span class="n">download</span> <span class="n">en_core_web_sm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">spacy</span>

<span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;en_core_web_sm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># spacy pretrained model</span>
<span class="n">test_doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">inf_text</span><span class="p">)</span>
<span class="p">[(</span><span class="n">e</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">test_doc</span><span class="o">.</span><span class="n">ents</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ours</span>
<span class="p">[(</span><span class="n">e</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="evaluation">
<h2>Evaluation<a class="headerlink" href="#evaluation" title="Link to this heading">#</a></h2>
<p>In this section, we’ll use the <code class="docutils literal notranslate"><span class="pre">valid_post_training</span></code> list of examples to calculate an F1 score for our model. This score is a good summary of how well our model does on this NER task, as it not only counts what entities the model correctly identified, but also considers if their labels are correct as well.</p>
<p>F1 score is the harmonic mean of <em>precision</em>, the ratio of correctly identified entities (true positives, TP) and all identified entities (the sum of true positives and false positives, FP), and <em>recall</em>, the ratio of correctly identified entities (TP) and all true entities (true positives and false negatives, FN).</p>
<p><span class="math notranslate nohighlight">\(Precision = \frac{TP}{TP+FP}\)</span></p>
<p><span class="math notranslate nohighlight">\(Recall = \frac{TP}{TP+FN}\)</span></p>
<p><span class="math notranslate nohighlight">\(F1 = \frac{2*Precision*Recall}{Precision+Recall} = \frac{2*TP}{2*TP+FP+FN}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">valid_post_training</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">valid_post_training</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">spacy</span>

<span class="n">trained_nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;models/model-best&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">trained_nlp</span><span class="p">(</span><span class="n">valid_post_training</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">predicted_ents</span> <span class="o">=</span> <span class="p">[(</span><span class="n">d</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">]</span>
<span class="n">predicted_ents</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">true_ents_raw</span> <span class="o">=</span> <span class="n">valid_post_training</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">]</span>
<span class="n">true_ents</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t_e</span> <span class="ow">in</span> <span class="n">true_ents_raw</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">valid_post_training</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">t_e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">t_e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">true_ents</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">text</span><span class="p">,</span> <span class="n">t_e</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">true_ents</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">predicted_ents</span><span class="p">)</span>
<span class="n">true_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">true_ents</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">true_positives</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">predicted_set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">true_set</span><span class="p">))</span>
<span class="n">false_positives</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">predicted_set</span> <span class="o">-</span> <span class="n">true_set</span><span class="p">)</span>
<span class="n">false_negatives</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">true_set</span> <span class="o">-</span> <span class="n">predicted_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">precision</span> <span class="o">=</span> <span class="n">true_positives</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_positives</span> <span class="o">+</span> <span class="n">false_positives</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">true_positives</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_positives</span> <span class="o">+</span> <span class="n">false_negatives</span><span class="p">)</span>
<span class="n">f1_score</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">f1_score</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">eval_one</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">trained_nlp</span><span class="p">(</span><span class="n">valid_post_training</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">predicted_ents</span> <span class="o">=</span> <span class="p">[(</span><span class="n">d</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">]</span>

    <span class="n">true_ents_raw</span> <span class="o">=</span> <span class="n">valid_post_training</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;entities&quot;</span><span class="p">]</span>
    <span class="n">true_ents</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">t_e</span> <span class="ow">in</span> <span class="n">true_ents_raw</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">valid_post_training</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">t_e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">t_e</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">true_ents</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">text</span><span class="p">,</span> <span class="n">t_e</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="n">predicted_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">predicted_ents</span><span class="p">)</span>
    <span class="n">true_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">true_ents</span><span class="p">)</span>

    <span class="n">true_positives</span> <span class="o">=</span> <span class="n">predicted_set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">true_set</span><span class="p">)</span>
    <span class="n">false_positives</span> <span class="o">=</span> <span class="n">predicted_set</span> <span class="o">-</span> <span class="n">true_set</span>
    <span class="n">false_negatives</span> <span class="o">=</span> <span class="n">true_set</span> <span class="o">-</span> <span class="n">predicted_set</span>

    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">true_positives</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">false_positives</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">false_negatives</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>  <span class="c1"># for the progress bar</span>

<span class="n">all_true_positives</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">all_false_positives</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">all_false_negatives</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_post_training</span><span class="p">))):</span>
    <span class="k">if</span> <span class="s2">&quot;entities&quot;</span> <span class="ow">in</span> <span class="n">valid_post_training</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">tp</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">fn</span> <span class="o">=</span> <span class="n">eval_one</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">all_true_positives</span> <span class="o">+=</span> <span class="n">tp</span>
        <span class="n">all_false_positives</span> <span class="o">+=</span> <span class="n">fp</span>
        <span class="n">all_false_negatives</span> <span class="o">+=</span> <span class="n">fn</span>

<span class="n">precision</span> <span class="o">=</span> <span class="n">all_true_positives</span> <span class="o">/</span> <span class="p">(</span><span class="n">all_true_positives</span> <span class="o">+</span> <span class="n">all_false_positives</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">all_true_positives</span> <span class="o">/</span> <span class="p">(</span><span class="n">all_true_positives</span> <span class="o">+</span> <span class="n">all_false_negatives</span><span class="p">)</span>
<span class="n">f1_score</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">round</span><span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># not too shabby!</span>
</pre></div>
</div>
</div>
</div>
<p>Yay! We did it!</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="encoder-pytorch.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Encoder-only Transformers: Bidirectional Encoder Representations from Transformers (BERT)</p>
      </div>
    </a>
    <a class="right-next"
       href="rnn-pytorch.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Machine Translation (mostly) from Scratch using <code class="docutils literal notranslate"><span class="pre">PyTorch</span></code></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item"><div
  id="pst-page-navigation-heading-2"
  class="page-toc tocsection onthispage"
>
  <i class="fa-solid fa-list"></i> Extracting Ancient Placenames using Named Entity Recognition and <code class="docutils literal notranslate"><span class="pre">spaCy</span></code>
</div>
<nav
  class="bd-toc-nav page-toc"
  aria-labelledby="pst-page-navigation-heading-2"
>
  <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Extracting Ancient Placenames using Named Entity Recognition and <code class="docutils literal notranslate"><span class="pre">spaCy</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#scraping">Scraping</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-1">TASK 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer">Answer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#completing-our-training-data">Completing our training data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#training">Training</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-2">TASK 2</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#inference">Inference</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation">Evaluation</a></li>
</ul>
</li>
</ul>

</nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/TuftsRT/guides/edit/main/source/nlp/deep-learning/ner-spacy.ipynb">
      <i class="fa-solid fa-pencil"></i>
      
      
Suggest Edits 
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/nlp/deep-learning/ner-spacy.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item"><div class="tocsection report-error">
  <a
    href="https://github.com/TuftsRT/guides/issues/new?title=Error Report: nlp/deep-learning/ner-spacy"
    class="report-error-link"
    ><i class="fa-solid fa-triangle-exclamation"></i> Report Error
  </a>
</div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Tufts University.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item"><p class="last-updated">
  Last updated on Dec 05, 2025.
  <br/>
</p></div>
      
    </div>
  
  
    <div class="footer-items__center">
      
        <div class="footer-item"><p class="disclaimer">
  Linked external resources not affiliated with or endorsed by Tufts University.
  <br />
</p></div>
      
        <div class="footer-item"><div class="footer-links">
  <ul>
    
    <li><a href="https://access.tufts.edu/digital-accessibility-policy">Accessibility</a></li>
    
    <li><a href="https://oeo.tufts.edu/policies-procedures/non-discrimination-statement/">Non-Discrimination</a></li>
    
    <li><a href="https://www.tufts.edu/about/privacy">Privacy</a></li>
    
  </ul>
</div></div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><div class="switcher-with-label">
  <div class="switcher-label">
    <p>Version:</p>
  </div>
  
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div>
</div></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>